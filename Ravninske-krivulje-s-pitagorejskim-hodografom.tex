\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[slovene]{babel}
\usepackage{amsthm,amsfonts,amsmath,amssymb,url}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}

\textheight 210 true mm
\textwidth 146 true mm
\voffset=-17mm
\hoffset=-13mm

\newtheorem{Izrek}{{\sc Izrek}}[section]
\newtheorem{Trditev}[Izrek]{{\sc Trditev}}
\newtheorem{Lema}[Izrek]{{\sc Lema}}
\newtheorem{Posledica}[Izrek]{{\sc Posledica}}
\newtheorem{Definicija}[Izrek]{{\sc Definicija}}
\newtheorem{Domneva}[Izrek]{{\sc Domneva}}
\newtheorem{Zgled}[Izrek]{{\sc Zgled}}
\newtheorem{Opomba}[Izrek]{{\sc Opomba}}

\def\theIzrek{{\rm \arabic{section}.\arabic{Izrek}}}

\newenvironment{izrek}{\begin{Izrek}\sl}{\end{Izrek}}
\newenvironment{trditev}{\begin{Trditev}\sl}{\end{Trditev}}
\newenvironment{lema}{\begin{Lema}\sl}{\end{Lema}}
\newenvironment{posledica}{\begin{Posledica}\sl}{\end{Posledica}}
\newenvironment{definicija}{\begin{Definicija}\rm }{\end{Definicija}}
\newenvironment{domneva}{\begin{Domneva}\rm }{\end{Domneva}}
\newenvironment{zgled}{\begin{Zgled}\rm}{\end{Zgled}}
\newenvironment{opomba}{\begin{Opomba}\rm}{\end{Opomba}}

\newenvironment{dokaz}[1][{\sc Dokaz}]{\begin{proof}[#1]\renewcommand*{\qedsymbol}{\(\square\)}}{\end{proof}}

\newcommand{\Mod}[1]{\hbox{ (mod } #1)}

\begin{document}

\thispagestyle{empty}
\begin{center}
\begin{Large}
{\bf Ravninske krivulje s pitagorejskim hodografom}
\end{Large}
\\[5mm]
\begin{large}
Seminarska naloga pri predmetu {\em Računalniško podprto geometrijsko oblikovanje }
\\[5mm]
\begin{center}
	\includegraphics{fmf.png}	
\end{center}
\vspace*{\fill}

{\sc Damijan Randl in Tit Arnšek}
\\[10mm]
~januar, 2023
\end{large}

\end{center}

\newpage
\tableofcontents

% \listoffigures
\newpage
\setcounter{page}{1}
% UVOD - ??

\section{Uvod}
Polinomske krivulje s pitagorejskim hodografom (PH krivulje) sta prvič predstavila Farouki in Sakkalis, leta 1990.
V zadnjih letih so te krivulje postale aktivno področje raziskav,
to pa zaradi svojih posebnih lastnosti, 
saj imajo prednost pri uporabi v računalniško podprtem oblikovanju,
proizvodnji (CNC razrez), robotiki, načrtovanju poti, animacijah in v drugih 
podobnih področjih. Glavni razlog je v tem, da lahko njihovo dolžinono enostavno izračuna natančno,
njihove paralelne krivulje pa imajo vedno racionalno parametrizacijo.
\newline
Za splošne krivulje ti dve lastnosti ne veljata vedno, 
kar lahko v praksi povzroči določene probleme (naprimer, pri dizajniranju paralelne krivulje 
moramo iskati numerične približke, kar je lahko časovno zahtevno,
zaradi iskanja približkov pa lahko pride tudi do napak).

\section{PH krivulje}

\begin{Definicija}
	
	Hodograf odvedljive parametrične krivulje $r (t) = \begin{bmatrix} x(t) \\ y(t) \end{bmatrix} \in \mathbb{R}^2$ 
	je definiran s predpisom $$r'(t) = \begin{bmatrix} x'(t) \\ y'(t) \end{bmatrix}.$$
\end{Definicija}
\begin{Definicija}
	Polinomska krivulja $r \in \mathbb{R}^2$ je krivulja s Pitagorejskim hodografom (PH), če velja naslednji pogoj:
	$$x'(t)^2 + y'(t)^2 = \sigma(t)^2, \text{ za nek polinom } \sigma.$$
\end{Definicija}

\begin{Izrek}{Kubota}\newline
	Polinomi $a$, $b$ in $c$ zadostijo pitagorejskemu pogoju
	$$a^2(t) + b^2(t) = c^2(t),$$
	natanko tedaj, ko jih lahko izrazimo s polinomi $u(t), v(t)$ in $w(t)$ v obliki
	$$a(t) = (u^2(t) - v^2(t))w(t),$$
	$$b(t) = 2u(t)v(t)w(t),$$
	$$c(t) = (u^2(t) + v^2(t))w(t),$$
	kjer $u$ in $v$ nimata skupnih ničel.
\end{Izrek}
Dokaz zgornjega izreka je malo daljši. Podrobno je opisan v  \cite{knjiga} na strani 382.
% Karakterizirane so z lastnostjo, da je njihova parametrična hitrost oziroma odvod ločne dolžine v odvisnosti od parametra,
% polinomska funkcija. Polinomske PH krivulje tvorijo pomemben razred parametričnih polinomskih krivulj
% za katere velja, da je njihova ločna dolžina lahko določena eksaktno in da so njeni odmiki (paralelne krivulje) racionalne krivulje.
% Zaradi naštetih lastnosti so zelo uporabne v sistemih CAD/CAM, robotiki, animacijah, NC machining??, spatial path planning based on rotation-minimizing frames?????...
Za Ph krivulje torej velja naslenje:
$$x'(t) = (u^2(t) - v^2(t))w(t),$$
$$y'(t) = 2u(t)v(t)w(t),$$
$$\sigma(t) = (u^2(t) + v^2(t))w(t),$$
Oglejmo si nekaj robnih primerov:
\begin{itemize}
	\item Če velja, da je $w\equiv0$ ali $u\equiv v \equiv 0$, potem $r(t)$ predstavlja točko.
	\item Če so $u$, $v$ in $w$ konstante in $w \not\equiv 0$, vsaj eden od $u, v$ neničelna konstanta, potem $r(t)$ predstavlja enakomerno parametrizirano daljico.
	potem je PH krivulja enakomerno parametrizirana daljica.
	\item Če sta $u$ in $v$ konstanti, $w$  ni konstanta, potem je  $r(t)$ neenakomerno parametrizirana daljica ali premica.
	\item Če je $w \not\equiv 0$ in $u = \pm v$ ali vsaj eden od $u, v$ ničelni polinom, 
	potem $r(t)$ neenakomerno parametrizirana daljica.
\end{itemize}
\begin{Opomba}
	Če je $w$ polinom stopnje $n$ in z $m$ označimo večjo izmed stopenj polinomov $u$ in $v$, 
potem je PH krivulja dobljena z integracijo hodografa stopnje $k = n + 2m + 1$
\end{Opomba}

% BEZIERJEVE KONTROLNE TOČKE KRIVULJ S PH - DAMIJAN
\section{B\'ezierjeve kontrolne točke PH krivulj}
V nadaljevanju se bomo osredotočili na hodografe kjer je $w(t) = 1$ in je $GCD(u,v)$ konstanta.
Imenjujemo jih primitivni Pitagorejski hodografi. 
Takšni hodografi definirajo regularne PH krivulje, ki zadostujejo pogoju $r'(t) \neq 0$ za vsak $t$. 
Iz opombe (stevilka) sledi, da je stopnja PH krivulje, definirane z integracijo
primitivnih hodografov, lihe stopnje $(k = 2m + 1)$.

Karakterizacijo PH krivulj želimo izraziti v Bezierjevi obliki.

Oglejmo si primer primitivne PH krivulje 3. stopnje v Bezierjevi obliki:
Zapišimo $u$ in $v$ v Bernsteinovi bazi in pri tem upoštevamo pogoj $w(t) = 1$
$$u(t) = u_0 B^1_1(t), v(t) = v_0 B^1_0(t) + v_1 B^1_1(t)$$
Ker sta $u$ in $v$ tuja, sledi, da mora biti $u_0*v_1 \neq u_1*v_0$. Iz dejstva, da
$u$ in $v$ nista obe konstanti, pa sledi $(u_0 - u_1)^2 + (v_0 - v_1)^2 \neq 0$.

Z upoštevanjem zgornjega izreka pa dobimo naslednja predpisa za $x'(t)$ in $y'(t)$
$$x'(t) = (u_0^2 - v_0^2) B_0^2(t) + (u_0 u_1 - v_0 v_1) B_1^2(t) + (u_1^2 - v_1^2) B_2^2(t),$$
$$y'(t) = 2 u_0 v_0 B_0^2(t) + (u_0 v_1 + u_1 v_0) B_1^2(t) + 2 u_1 v_1 B_2^2(t).$$

Definirajmo sedaj (brez dokaza) še pravilo za integriranje Bernstainovih baznih polinomov:
Z integracijo dobimo kubično Bezierjevo krivuljo podano s predpisom:
$$p(t) = b_0*B_0^3(t) + b_1*B_1^3(t) + b_2*B_2^3(t) + b_3*B_3^3(t)$$

kjer je
$$b_1 = b_0 + \frac{1}{3}*(u_0^2 - v_0^2, 2*u_0*v_0)^T,$$
$$b_2 = b_1 + \frac{1}{3}*(u_0*u_1 - v_0*v_1, u_0*u_1 + v_0*v_1)^T,$$
$$b_3 = b_2 + \frac{1}{3}*(u_1^2 - v_1^2, 2*u_1*v_1)^T,$$

Pri tem je $p_0$ prosto izbrana kontrolna točka (zaradi konstante pri integraciji).
\section{Parametrična hitrost in dolžina loka}
% PARAMETRIČNA HITROST IN DOLŽINA LOKA - TIT
% \section*{Parametrična hitrost in dolžina loka}

Parametrična hitrost regularne PH krivulje $r(t) = (x(t), y(t))$ je podana s predpisom:
$$ || r\prime (t) || =\sqrt{x\prime^2(t)+y\prime^2(t)}= u^2 (t) + v^2 (t) = \sigma (t)$$
in je polinom. \newline
Iz lastnosti, da je krivulja $r$, ki jo dobimo z integrinjanjem stopnje $n = 2m + 1$, sledi
da morata biti polinoma $u$ in $v$ stopnje  $m = \frac{1}{2}(n - 1)$. Zapišemu ju lahko v 
Bernstainovi bazi:

	$$u (t)=\sum_{k=0}^m u_kB_k^m(t) \text{ in } v (t) =\sum_{k=0}^m v_kB_k^m(t).$$
	

Izkaže se, da je 
$$\sigma (t) =\sum_{k=0}^{n-1} \sigma_kB_k^{n-1}(t), \text{kjer so koeficienti }$$ 

$$\sigma_k =\sum_{j=max(0,k-m)}^{min(m,k)}\frac{\binom{m}{j}\binom{m}{k-j}}{\binom{n-1}{k}}(u_ju_{k-j}+v_jv_{k-j}), k = 0,\ldots , n - 1.$$
\newline
Če pogledamo primer od zgoraj(kubično B. krivuljo) dobimo naslednje koeficiente za $\sigma $ :

$\sigma_0 = u^2_0+ v^2_0, $
$\sigma_1 = u_0u_1 + v_0v_1,$ in  
$\sigma_2 = u^2_1+ v^2_1.$
\newline
Dolžino loka dobimo na naslednji način:
$$s (t) =\int^t_0\sigma(\tau) d\tau.$$
Z upoštevanjem integracijskega pravila se nam zgornji izraz poenostavi: 
$$s (t) =\sum^n_{k=0}s_k\binom{n}{k}(1-t)^{n-k}t^k=\sum_{k=0}^n s_kB^n_k(t),$$
kjer je $s_0=0$ in $s_k=\frac{1}{n}\sum^{k-1}_{j=0}\sigma_j, k=1,\ldots,n.$
\begin{Opomba}
	Skupna dolžina loka je $S(1)$. 
\end{Opomba}

Iz lastnosti odvoda PH krivlj sledi, da so enotski tangentni vektor,
normala in ukrivljenost racionalno odvisni od parametra krivulje. Natančeneje: 
$$\textbf{t} =\frac{(u^2 - v^2, 2uv)}{\sigma},\hspace{10pt} \textbf{n} =\frac{(2uv, v^2 - u^2)}{\sigma},\hspace{10pt} \kappa = 2 \frac{uv\prime - u\prime v}{\sigma^2}.$$

\subsection*{Newton-Raphsonova iteracija}
Običajno se Bezierjeve krivulje prikaže z vrednotenjem vrednosti parametrov  $t_0,\ldots , t_N$, kjer so bili razmiki enakomerni.
S tem se običajno dobi neenakomerno porazdeljene točke na krivulji, saj parametrična 
hitrost, v splošnem, ni konstantna.
Če želimo doseči, da bodo točke $s(t_k)$ vseeno enakomerno porazdeljene na grafu,
lahko to dosežemo tako, da za vsak $t_k$ izračunamo nov paramater, ki ga dobimo 
s pomočjo Newton-Raphsonove iteracije: 
$$t^{(0)}_k = t_{k-1}+\frac{\Delta s}{\sigma(t_{k-1})}$$
$$t^{(r)}_k = t^{(r-1)}_k-\frac{s(t^{(r-1)}_k)-k\Delta s}{\sigma(t^{(r-1)}_k)}, r = 1, 2,\ldots.$$
Za dobre rezultate je dovolj že nekaj iteracij.



% RACIONALNI ODMIKI KRIVULJ S PH - DAMIJAN 
\section{Racionalni odmiki PH krivulj}
Racionalni odmiki PH krivulj
Odmik krivulje r(t) je v splošnem definiran kot
$$ r_d(t) = r(t) + dn(t)$$
V primeru, da r(t) pri tem predstavlja Bezierjevo PH krivuljo velja, 
da $r_d(t)$ spada med racionalne Bezierjeve krivulje. V primeru kubične PH krivilje 
je njen odmik 5. stopnje. Normala n je pri tem enaka, kot smo jo definirali zgoraj:
$$\textbf{n} =\frac{(2uv, v^2 - u^2)}{\sigma}$$,
kjer je $\sigma$ parametrična hitrost krivulje r.

Definirajmo kontrolne točke krivulje r v homogenih koordinatah kot
$$ P_k = (W_k, X_k, Y_k) = (1, x_k, y_k), k = 0, ..., n.$$
Z $$\Delta P_k = P_{k+1}-P_k = (0, \Delta x_k, \Delta y_k), k = 0, ..., n-1$$ 
pa definirajmo razlike med njimi. Pri tem so $$\Delta x_k = x_{k+1} - x_k$$ in $$\Delta y_k = y_{k+1} - y_k$$
Označimo še $$ \Delta P_k^{\perp} = (0, \Delta y_k, - \Delta x_k)$$. Potem lahko
racionalni odmik PH krivulje r(t) zapišemo kot
$$ r_d(t) = (\frac{X(t)}{W(t)}, \frac{Y(t)}{W(t)})$$,
kjer so W, X in Y polinomi stopnje $$2n -1$$, katerih koeficienti 
$$ O_k = (W_k, X_k, Y_k), k = 0, ..., 2n-1$$
definirajo kontrolne točke racionalne Bezierjeve krivulje. 
Homogene koordinate kontrolnih točk pa lahko izrazimo tudi s pomočjo kontrolnih točk podane začetne krivulje:
$$ O_k = \sum_{j=max(0,k-n)}^{min(n-1,k)}{\frac{\binom{n-1}{j}\binom{n}{k-j}}{\binom{2n-1}{k}}(\sigma_j P_{k-j}+d n \Delta P^{\perp}_{j})}, k = 0, ..., 2n-1.$$

Kontrolne točke racionalnega odmika kubičnih PH krivulj so tako podane kot:
$$ O_0 = \sigma_0 P_0 + 3 d \Delta P_0^{\perp}$$,
$$ O_1 = \frac{1}{5} [2 \sigma_1 P_0 + 3\sigma_0 P_1 + 3 d (3 \Delta P_0^{\perp} + 2 \Delta P_1^{\perp})]$$,
$$ O_2 = \frac{1}{10} [\sigma_2 P_0 + 6\sigma_1 P_1 + 3\sigma_0 P_2 + 3 d (3 \Delta P_0^{\perp} + 6 \Delta P_1^{\perp}) + \Delta P_2^{\perp})]$$,
$$ O_3 = \frac{1}{10} [3\sigma_2 P_1 + 6\sigma_1 P_2 + \sigma_0 P_3 + 3 d (\Delta P_0^{\perp} + 6 \Delta P_1^{\perp} + 3 \Delta P_2^{\perp})]$$,
$$ O_4 = \frac{1}{5} [3\sigma_2 P_2 + 2\sigma_1 P_3 + 3 d (2\Delta P_1^{\perp} + 3 \Delta P_2^{\perp})]$$,
$$ O_5 = \sigma_2 P_3 + 3 d \Delta P_2^{\perp}$$


% \begin{figure}[h]
% 	\centering
% 	\begin{minipage}{.5\textwidth}
% 		\centering
% 		\includegraphics[width=.4\linewidth]{slika_5.png}
% 		\caption{Bezierjeva krivulja stopnje 5 z odmikoma}
% 		\label{fig:n2m3}
% 	\end{minipage}%

% 	\begin{minipage}{.5\textwidth}
% 		\centering
% 		\includegraphics[width=.4\linewidth]{slika_4.png}
% 		\caption{Bezierjeva krivulja stopnje 3 z odmiki}
% 		\label{fig:n3m4}
% 	\end{minipage}
% 	\label{fig:nm}
% \end{figure}
\begin{figure}[h]
    \centering
    \subfloat[\centering label 1]{{\includegraphics[width=5cm]{slika_5.png} }}%
    \qquad
    \subfloat[\centering label 2]{{\includegraphics[width=5cm]{slika_4.png} }}%
    \caption{2 Figures side by side}%
    \label{fig:example}%
\end{figure}



\begin{thebibliography}{1}
	\bibitem{knjiga} R. T. Farouki: \textit{Pythagorean-Hodograph Curves: Algebra and Geometry Inseparable}, Springer, 2008
\end{thebibliography}

\end{document}